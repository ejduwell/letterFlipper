
<div align="center">

![letterFlipper_logoAscii](https://github.com/ejduwell/letterFlipper/blob/main/gh_READMEimgs/letErFlip_logoImg_snapshot_ascii.png)

</div>

# letterFlipper

Repository of code which establishes a generalized framework for building and running visual stimuli presenting letters in MATLAB with Psychtoolbox.

## Quick Links to Specific Sections:

- [General Overview](https://github.com/ejduwell/letterFlipper/tree/main?tab=readme-ov-file#general-overview)
- [Dependencies](https://github.com/ejduwell/letterFlipper/tree/main?tab=readme-ov-file#dependencies)
- [Installation](https://github.com/ejduwell/letterFlipper/tree/main?tab=readme-ov-file#installation)
- [Usage](https://github.com/ejduwell/letterFlipper/tree/main?tab=readme-ov-file#usage)
- [Task Data Output](https://github.com/ejduwell/letterFlipper/tree/main?tab=readme-ov-file#task-data-output)
- [Data Analysis and Visualization](https://github.com/ejduwell/letterFlipper/tree/main?tab=readme-ov-file#data-analysis-and-visualization)

## General Overview:

**letterFlipper** is a MATLAB repository developed for building and implimenting cognitive vision science experiments presenting letter stimuli with Psychtoolbox. **letterFlipper** contains generalized code enabling users to quickly and flexibly design and run wide range of potential visual tasks presenting letters/characters.

### Brief Description of Features/Capabilities:

- Separate functions and workflows for image/task creation and task presentation enable users to develop and impliment tasks in a modular manner:
    - **letterFlipper** has separate, 'stand-alone' functions/workflows for both generating the stack of images and files presented in an experiment and for presenting them in the precise manner desired.
    - In other words, **letterFlipper** allows users to flexibly pre-generate a set of task images/rules with a "letter image/task generation" workflow and impliment/present them in desired manner using a separate "letter image flipper" task presentation workflow.
      
- Frameworks for creating and running tasks are highly generalized and are capable of both generating and implimenting a wide range of potential different tasks with minimal coding.
    - **Q:** *How does **letterFlipper** achieve this?* **A:** *Parameter Descriptor Files!*
      - Users can flexibly create and update 'parameter descriptor files' (see [Usage](https://github.com/ejduwell/letterFlipper/tree/main?tab=readme-ov-file#short-list-of-important-files-and-foldersdirectories) for details)
      - These allow users to define/specify all relevant aspects of task.
      - The "image flipper" for presenting stimuli and collecting data is highly generalized and can run any task generated by the "letter image/task generation workflow" without any updating or re-coding.
      - Consequently, [users can create, develop, and run a wide range of letter-based visual stimuli with **letterFlipper** by simply specifying new sets of parameters in different parameter descriptor files.](https://github.com/ejduwell/letterFlipper/tree/main?tab=readme-ov-file#general-workflow-for-creating-and-running-stimuli-with-letterflipper)
        
- Task image parameter maniplations currently supported by letterFlipper out-of-the-box allow users to specify:
  - the set of letters presented
      - a 'Snellen E Mode" allows users to generate and present 'Snellen-like' letter 'E' stimuli similar to those used in clinical ophthalmology exams
  - the number of letters presented per task image.
  - the set of different locations in which letters can appear
  - the set of possible text sizes
  - the set of possible text colors/luminance values in the form of rgb vectors
  - the set of possible rotation angles applied to letters
  - specify which of these parameters is the "response parameter" to which subjects will be responding via pressing butons thoughout the task
  - specify the corresponding set of expected button presses for each possible response parameter value
  - specify which parameter will be manipulated by QUEST to control task difficulty

- Task presentation/implimentation parameter maniplations currently supported by letterFlipper out-of-the-box allow users to specify:
    - the # of trials per run
    - the number of runs per block
    - low-level trial architecture / timing parameters such as:
      - image presentation onset and disappearance times
      - response window length
      - interstimulus interval time between trials
    - QUEST-related parameters controling how the QUEST staircase procedure will function during the task including:
      - total # of interleaved QUEST procedures to run (Can handle any desired # of interleaved QUESTS from 1 to N)
      - the desired accuracy threshold for each QUEST to 'home in on'
      - QUEST starting parameter values

## Dependencies:

- MATLAB R2021a or newer
- Required Toolbox(es):
  - MATLAB (base)
  - [Deep Learning Toolbox](https://www.mathworks.com/help/deeplearning/index.html?s_tid=srchtitle_site_search_1_Deep+learning+toolbox)
  - [Computer Vision Toolbox](https://www.mathworks.com/help/vision/index.html?s_tid=srchtitle_site_search_1_Computer+vision+toolbox)
  - [Psychtoolbox 3](http://psychtoolbox.org/) (I developed this repository using version [3.0.19.13](https://github.com/Psychtoolbox-3/Psychtoolbox-3/tree/3.0.19.13))

## Installation:

### macOS and Linux

Open a terminal and run:

```bash
# Navigate to desired install location
cd ~/Documents/MATLAB
```

```bash
# Clone the repository from GitHub
git clone https://github.com/ejduwell/letterFlipper.git
```

```bash
# Open MATLAB and add the project to your path:
addpath(genpath('~/Documents/MATLAB/letterFlipper'))
savepath
```

### Windows

1. Open MATLAB
2. In the Command Window, run:

```matlab
% Change directory to desired location
cd('C:\Users\YourName\Documents\MATLAB')
```

```matlab
% Clone from GitHub (or download ZIP and unzip manually)
system('git clone https://github.com/ejduwell/letterFlipper.git')
```

```matlab
% Add the project folder to your MATLAB path:
addpath(genpath('C:\Users\YourName\Documents\MATLAB\letterFlipper'))
savepath
```

## Usage:

### Short List of Important Files and Folders/Directories:

| File/Folder                         | Description                                                                                                             |
|-------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
| `letterFlipper/`                    | Main program directory. Contains Matlab code.                                                                           |
| `letterFlipper/stimImages/`         | Subdirectory where stimulus images are saved/stored.                                                                    |
| `letterFlipper/expDataOut/`         | Subdirectory where subjects' data are saved                                                                             |
| `txtPltCntrlFixImgStackBldr_v1.m`   | Main function for generating stimulus image sets                                                                        |
| `txtTaskImgBuilderPDF_01.m`         | 'Parameter Descriptor File' instance/template for defining adustable parameters used in txtPltCntrlFixImgStackBldr_v1.m |
| `genImgFlipperMain_v1.m`            | Main function for running/presenting stimuli                                                                            |
| `genImgFlipperPDF_01.m`             | 'Parameter Descriptor File' instance/template for defining adustable parameters used in genImgFlipperMain_v1.m          |
| `fitNakaRushton_example.m`          | Wrapper script for analyzeBinnedAccuracy_v6.m to illustrate basic usage/how to fit sigmoidal Naka Rushton curves        |
| `analyzeBinnedAccuracy_v6.m`        | Primary function called by fitNakaRushton_example.m to bin accuracy data and fit models.                                |
| `fitNakaRushton_v2.m`               | Function called by analyzeBinnedAccuracy_v6.m that does the actual model fitting.                                       |

### General workflow for creating and running stimuli with letterFlipper:

As described above, **letterFlipper** is capbable of generating and running a wide range of potential stimulus designs.

However, regardless of the details of any particular use case, the creation of tasks with letterFlipper should always follow the following general workflow:

---
> - **Step 00:** Make a new `txtTaskImgBuilderPDF_##.m` instance/copy for this task, and adjust parameters to set desired stimulus image and response parameters
> - **Step 01:** Update a single parameter in `txtPltCntrlFixImgStackBldr_v1.m` to point to your new `txtTaskImgBuilderPDF_##.m` file, then run it to generate the desired stimulus image files.
> - **Step 02:** Make a new `genImgFlipperPDF_##.m` instance/copy for this task pointing to stimulus files created in **Step 01** and adjust other stimulus presentation parameters as desired.
> - **Step 03:** Update a single parameter in `genImgFlipperMain_v1.m` to point to your newly created `genImgFlipperPDF_##.m` instance.
> - **Step 04:** Run `genImgFlipperMain_v1.m` to run the task.
---

### Detailed instructions for letterFlipper workflow:

Below are more detailed instructions to walk you through each of the 5 steps in the section above.

---
> ### Step 00: 
> - Make a new `txtTaskImgBuilderPDF_##.m` instance/copy for this task, and adjust parameters to set desired stimulus image and response parameters
---
> *Step 00a:* make a copy of the `txtTaskImgBuilderPDF_01.m` template in the main `letterFlipper/` folder and give it a unique name. For the purposes of this instruction demo lets call it `txtTaskImgBuilderPDF_yourName.m`

> *Step 00b:* Edit/update the parameters in each section of `txtTaskImgBuilderPDF_yourName.m` to specify the content of the task letter image set, expected button presses, and all other parameters accepted by `txtPltCntrlFixImgStackBldr_v1.m` , the 'main function' for the 'image/task generation' workflow:

> #### Under the section titled *Specify Parameters that vary across images*:
```matlab
% Build out set of letters
%--------------------------------------------------------------------------
parStruct.letterSet={'E'};% specify letters you wish to include (1xN cell)
parStruct.SnellenEmode=1; % if 1, will build "snellen Es" instead of drawing normal text..
%--------------------------------------------------------------------------
```

```matlab
% Build out set of locations
%--------------------------------------------------------------------------
parStruct.nEcc=1; % specify number of eccentricity values
parStruct.MinMaxEcc=[0,0]; % set max/min eccentricity
parStruct.nAng=1; % specify number of angle values 
parStruct.MinMaxAng=[0,0]; % for nAng evenly spaced between 0 and 360
% (line below automatically generates the set of coordinates with the pars 
% specified above using genEccAngSet_v1)
parStruct.LocationSet = genEccAngSet_v1(parStruct.nEcc, parStruct.nAng, parStruct.MinMaxEcc, parStruct.MinMaxAng);
%--------------------------------------------------------------------------
```

```matlab
% Build out set of text sizes
%--------------------------------------------------------------------------
parStruct.nTxtSizes=71; % set desired number of different text sizes
parStruct.txtSizeMinMax=[5,75]; % set min and max text size
% (line below automatically generates the set of text sizes with the pars 
% specified above using linspace)
parStruct.txtSizeSet=num2cell(linspace(parStruct.txtSizeMinMax(1),parStruct.txtSizeMinMax(2),parStruct.nTxtSizes));
%--------------------------------------------------------------------------
```

```matlab
% Build out set of text colors
%--------------------------------------------------------------------------
% specify set of rgb vectors to set the possible text color/luminance vals
parStruct.txtClrSet={
    [0,0,0],... % (one rgb vector per line)
    };
%--------------------------------------------------------------------------
```

```matlab
% Build out set of text rotation angles
%--------------------------------------------------------------------------
% note, angles assume clockwise rotation..
parStruct.txtAngSet={
    0,...
    90,...
    -90,...
    180,...
    };
%--------------------------------------------------------------------------
```

> ***Note:** the following 3 should be updated together such that the parameter names, sets, and header names correspond to the same stimulus aspect.*

```matlab
% List Names for Sets Pars Changing Across Images
%--------------------------------------------------------------------------
parStruct.combVecParNames={
    "setOfLetters",...
    "setOfLocations",...
    "txtSize",...
    "txtClr",...
    "setOfAngles",...
    };
%--------------------------------------------------------------------------

% List Corresponding Sets of Pars Changing Across Images
%--------------------------------------------------------------------------
parStruct.combVecPars={
    parStruct.letterSet,...
    parStruct.LocationSet,...
    parStruct.txtSizeSet,...
    parStruct.txtClrSet,...
    parStruct.txtAngSet,...
    };
%--------------------------------------------------------------------------

% List TDF Header Label Names for Sets Pars Changing Across Images
%--------------------------------------------------------------------------
parStruct.tdfHeaderz={
    "Letter",...
    "Location",...
    "TextSize",...
    "TextColor",...    
    "TextRotation",...
    };
%--------------------------------------------------------------------------
```
    
> #### Under the section titled *Generate full set of all possible images with combVecCellz2Struct_v1*:
> - You shouldn't need to change anything here.
> - The one command run in this section (combVecCellz2Struct_v2) takes the parameter sets defined in the previous section and generates the full set of possible combinations efficiently using the combvec function.

    
>  #### Under the section titled *Specify parameter for responses*:

```matlab
parStruct.respParName=parStruct.combVecParNames{1,5}; % specify par name in combVecParNames
parStruct.respColName=parStruct.tdfHeaderz{1,5}; % specify column name in tdfHeaderz
% Automatically save the index too..
parStruct.respParIdx = find(cellfun(@(x) isequal(x, parStruct.respParName), parStruct.combVecParNames));
```
    
>  #### Under the section titled *Specify parameter for QUEST to manipulate*:

```matlab
parStruct.qstParName=parStruct.combVecParNames{1,3}; % specify par name in combVecParNames
parStruct.qstColName=parStruct.tdfHeaderz{1,3}; % specify column name in tdfHeaderz
% Automatically save the index too..
parStruct.qstParIdx = find(cellfun(@(x) isequal(x, parStruct.qstParName), parStruct.combVecParNames));
```
    
>  #### Under the section titled *Specify Buttons and Build Correct Button Column*:

```matlab
parStruct.buttons=upper({'W','D','A','S'}); % set buttons. ensure uppercase..

% Build out parKeyPressDecoder:
% each row is for a single parameter and should contain a 1x2 cell array.
% the first variable in each cell array should be the parameter value, the
% second variable in each cell array should be the expected character
% string for desired "correct" button press for that par value
%--------------------------------------------------------------------------
parStruct.parKeyPressDecoder={
    {parStruct.combVecPars{1,parStruct.respParIdx}{1,1},parStruct.buttons{1,1}}, ...
    {parStruct.combVecPars{1,parStruct.respParIdx}{1,2},parStruct.buttons{1,2}}, ...
    {parStruct.combVecPars{1,parStruct.respParIdx}{1,3},parStruct.buttons{1,3}}, ...
    {parStruct.combVecPars{1,parStruct.respParIdx}{1,4},parStruct.buttons{1,4}}, ...
    };
%--------------------------------------------------------------------------

% Build out the "correct button press" array automatically using Ethan's
% respPar2KeyPress_v1 function, the response parameter in the first input
% position, and the parKeyPressDecoder in the second positon.
%--------------------------------------------------------------------------
parStruct.correctButtons = respPar2KeyPress_v1(parStruct.updatedImgPars.(parStruct.respParName),parStruct.parKeyPressDecoder);
%--------------------------------------------------------------------------
```

>  #### Under the section titled *Fixation point parameters...*:

```matlab
%--------------------------------------------------------------------------
parStruct.fixChar='+'; % specify which character to use for fixation
parStruct.fixSize=30; % fixation character size
parStruct.fixClr=[1,1,1]; % fixation character color
%--------------------------------------------------------------------------

```
    
>  #### Under the section titled *Set output stimulus image size..*:

```matlab
%--------------------------------------------------------------------------
parStruct.cropsz = 1024; % output edge dimension of screen & images (square)
%--------------------------------------------------------------------------
```

---
> ### Step 01:
> - Update a single parameter in `txtPltCntrlFixImgStackBldr_v1.m` to point to your new `txtTaskImgBuilderPDF_yourName.m` file, then run it to generate the desired stimulus image files.
---
> *Step 01a:* Open `txtPltCntrlFixImgStackBldr_v1.m` in you matlab editor and scroll to the 'Set Parameters' section

> *Step 01b:* Update the line defining the 'parDescFile' to set this variable equal to your new `txtTaskImgBuilderPDF_yourName.m` filename:

```matlab
% Specify which parameter descriptor file name to use..
parDescFile="txtTaskImgBuilderPDF_yourName";
```

> *Step 01c:* At the bottom of the 'Set Parameters', update the parameter called `outDirName` to set your desired output directory name:
> - for the purposes of this demo, we'll call it `"testTaskImgs"`
```matlab
outDirName="testTaskImgs"; % Specify name for output directory
```

> *Step 01d:* Run txtPltCntrlFixImgStackBldr_v1 either by hitting the green "Run" button in the editor window or by running it as a command in the Matlab command window:
```matlab
txtPltCntrlFixImgStackBldr_v1
```

> *Step01e:* When this is done running, check the `stimImages/` output directory for a new output subdirectory. It should be called `testTaskImgs` with a date/time stamp appended to the end, and should contain a single file called `stimImgData.mat`

---
> ### Step 02:
> - Make a new `genImgFlipperPDF_##.m` instance/copy for this task pointing to stimulus files created in **Step 01** and adjust other stimulus presentation parameters as desired.
---
> *Step 02a:* Make a copy of the `genImgFlipperPDF_01.m` template in the main `letterFlipper/` folder and give it a unique name. For the purposes of this instruction demo lets call it `genImgFlipperPDF_yourName.m`

> *Step 02b:* Open `genImgFlipperPDF_yourName.m` in you matlab editor, scroll to the 'Input Data/TDF Parameters' section. Update the line defining 'expParz.path2tdfMat' to set this variable equal to the full path to the .mat file generated in *Step01d-e*
```matlab
%--------------------------------------------------------------------------
% Specify path to .mat file containing the tdf
expParz.path2tdfMat="/home/eduwell/SynologyDrive/SNAP/projects/letterFlipper/stimImages/testTaskImgs_20251010T164755/stimImgData.mat";
%--------------------------------------------------------------------------
```
> *Step 02c:* Still within `genImgFlipperPDF_yourName.m`, scroll to the 'Screen Dimension Parameters' section and set parameters to desired values:
```matlab
% Specify proportion of screen to use
% Note: should be values ranging 0-1. 
% 1 means use full width/height
% 0.25 means use 25%, 0.5 means use 50%, etc...
expParz.widProp=0.5;
expParz.heiProp=1;
```
> *Step 02d:* Scroll to the 'Trial Structure/Timing Parameters' section and set trial architecture parameters to your desired values:
```matlab
% Specify the total number of trials desired for the experiment
expParz.numTrials=50;
% Presentation Time for the image in seconds (time after trial start that images appear)
expParz.presTimeSecs = 0.25;
% Interstimulus interval time in seconds
expParz.isiTimeSecs = 1;
% Number of frames to wait before re-drawing
expParz.waitframes = 1;
% Max time allowed for response.. (time at which images will disappear if a button is not pressed)
expParz.tRespMax=200; % set to large number if you want effectively unlimited response time..
```

> *Step 02e:* Scroll to the 'QUEST Parameters' section and set QUEST-related parameters to your desired values:
```matlab
expParz.qstParams=struct;
expParz.qstParams.questParTdfCol=1; % indicates column number for tdf col (don't change unless you know what you're doing)
expParz.qstParams.nQuests=3; % Set total number of interleaved QUESTs
expParz.qstParams.qstMinMax={5,75}; % Set Min and Max values for interleaved QUESTs
expParz.qstParams.qstThresholds={0.65,0.70,0.75}; % Set accuracy thresholds for each interleaved QUEST
% loop below 'auto-sets' other quest starting par for all..
for hh=1:expParz.qstParams.nQuests
    qStringTmp=strcat("q",num2str(hh));
    expParz.qstParams.(qStringTmp).thrhld = expParz.qstParams.qstThresholds{1,hh};
    expParz.qstParams.(qStringTmp).tGuess = mean(expParz.qstParams.qstMinMax{1,:}); % start at the mean of the range
    expParz.qstParams.(qStringTmp).tGuessSd = 0.3*(abs(expParz.qstParams.qstMinMax{1,1}-expParz.qstParams.qstMinMax{1,2}));  % set std. dev. to n% of the total possible parameter value range
    expParz.qstParams.(qStringTmp).grain = 0.01;
    expParz.qstParams.(qStringTmp).range = 2*(abs(expParz.qstParams.qstMinMax{1,1}-expParz.qstParams.qstMinMax{1,2})); % set quest range to 2 times total possible parameter range.
end

% general pars common to all quests.. (probably don't need/want to tweak
% these)
%--------------------------------------------------------------------------
expParz.qstParams.common.beta=3.5;
expParz.qstParams.common.delta=0.01;
expParz.qstParams.common.gamma=0.5;
%--------------------------------------------------------------------------
```

---
> ### Step 03:
> - Update a single parameter in `genImgFlipperMain_v1.m` to point to your newly created `genImgFlipperPDF_##.m` instance.
---

> *Step 03a:* Open `genImgFlipperMain_v1.m` and scroll to the 'Set Parameters' section near the top.

> *Step 03b:* Update the line defining the parameter `parsIn.parDescFile` to set it equal to your new PDF file `genImgFlipperPDF_yourName`
```matlab
parsIn.parDescFile="genImgFlipperPDF_yourName";
```

---
> ### Step 04:
> - Run `genImgFlipperMain_v1.m` to run the task:
---

>  *Step 04a:* Either push the green 'Run' button at the top of the editor window or run it as a command in your Matlab Command Window:
```matlab
genImgFlipperMain_v1
```
>  *Step 04b:* Provide requested command line inputs such as a subject id, etc. to begin task.

>  *Step 04c:* After providing these command line inputs, the task should begin and you should be greeted with the following start page:
![letterFlipper_startPage](https://github.com/ejduwell/letterFlipper/blob/main/gh_READMEimgs/letterFlipper_startPage.png)

> *Step 04d:*  After the subject presses any key, the task should begin.

> *Step 04e:* When the task is completed, the screen will close and data will be saved automatically in a subdirectory of the `expDataOut/` ouptut directory with a name matching the subject's id.
> - Within that subject's subdirectory, data from individual runs/blocks are saved within subdirectories named using the subject id with a unique time/date stamp appended.
> - .mat files for each run/block are saved within using the same naming schema.
> - in the interest of documentation and reproducability, a copy of the pdf file used in that run/block is also saved within named using the following naming scheme: `pdfFileFrmExmt_SID_UNIQUETSTAMP.m` where 'SID' is the subject's unique ID and 'UNIQUETSTAMP' is the unique timestamp from the run/block.
> - this feature was included to ensure there is always a record documenting the exact parameters used to create/run any given stimulus available for future reference.


## Task Data Output:

- As described in *Step 04e* of the detailed instructions above, the output data for each subject are saved within the `expDataOut/` output directory.

- To view a subject's data, within Matlab, navigate to that subject's subdirectory, enter that subject's subdirectory, and then enter the subdirectory within that subject's folder matching the timestamp of the session-of-interest

- Double clicking on the .mat file should load to variables into the workspace:
  - parsIn: a struct containing a single field 'parDescFile' containing the parameter descriptor file name used to run the experiment 
  - tdfOut: a cell array containing the data from the subject's expereriment run. The top row contains the header labels for each column. Subsequent rows contain data.

- 'tdfOut' is the variable you are likely interested in:
![letterFlipper_tdfExample](https://github.com/ejduwell/letterFlipper/blob/main/gh_READMEimgs/letterFlipper_tdfOutputExmpl.png)

- 'tdf' stands for 'trial descriptor file'. In this way, each row in the array represent a trial from the task.

- Column names are fairly descriptive and self-explanatory, but in the interest of clarity, a description of each is provided below:
```
column 01: "Letter"            -----> the target letter for the trial
column 02: "Location"          -----> location coordinate of target letter
column 03: "TextSize"          -----> size of target letter
column 04: "TextColor"         -----> color of target letter
column 05: "TextRotation"      -----> rotation of target letter
column 06: "CorrectButtons"    -----> the correct/expected button response for each trial
column 07: "StimulusImg"       -----> copy of the image presented for each trial
column 08: "SubjectResponses"  -----> the button the subject pressed for each trial
column 09: "ResponseTimes"     -----> the response time measured from the image onset to button press for each trial
column 10: "Correctness"       -----> indicates the correctness of subject's response for each trial. (0=incorrect, 1=correct)
column 11: "RespVarColNum"     -----> indicates which column number in this tdf contains the parameter subject's are responding to on each trial
column 12: "QUEST"             -----> indicates which interleaved QUEST suggested the QUEST-manipulated parameter on each trial
column 13: "QuestVarColNum"    -----> indicates which column contains the column number in this TDF of the parameter manipulated by QUEST on each trial
```

## Data Analysis and Visualization:

**letterFlipper** also includes a number of functions for limited analysis and visualization of response accuracy from the task output data.

At present, **letterFlipper** has functions which allow you to flexibly bin, compute bin-wise accuracy, and fit a sigmoidal Naka Rushton psychometric function to the output data.

As detailed in [the table above](https://github.com/ejduwell/letterFlipper/tree/main?tab=readme-ov-file#short-list-of-important-files-and-foldersdirectories), the two main functions that do the heavy lifting in binning the data, computing bin-wise accuracy, and fitting functions are `analyzeBinnedAccuracy_v6.m` and `fitNakaRushton_v2.m` 

`fitNakaRushton_example.m` is a 'wrapper script' for the two basic functions above. I included this to illustrate how to use the functions in an eventual data analysis pipeline, but also to provide users a rudimentary means of visualizing pilot data collected from tasks made with **letterFlipper** during development.

### How to use fitNakaRushton_example.m:

- First open fitNakaRushton_example.m and scroll to the 'Set Parameters' section

- Adjust the parameters to desired values. Comment is included within the script explaining the functionality of each:
```matlab
%% Set Parameters

% specify the path to a subject's .mat file task output
path2data="/home/eduwell/SynologyDrive/SNAP/projects/sandbox/pipeCleaner/cleanPrgrmDirsOut/letterFlipper/expDataOut/jnk/jnk_20251013T192221/jnk_20251013T192221.mat";

% specify desired output directory path (this is generated by the script)
dirOut="/home/eduwell/SynologyDrive/SNAP/projects/sandbox/pipeCleaner/cleanPrgrmDirsOut/letterFlipper/nrModelFitOut";

% set the subjID code for the subject whose data is contained in path2data
subjID="JNK";

% set titleStr: this string is added to the plot title for labeling
% purposes and also incorporated into the output figure filename
titleStr="randomString";

% Set Naka Rushton Model Fitting Pars:
%--------------------------------------------------------------------------
NRfitParsIn=struct; % initialize struct
% baseline par "b" upper, lower, bounds, and steps for start grid
NRfitParsIn.nr_bLower=0.25;
NRfitParsIn.nr_bUpper=1;
NRfitParsIn.nr_bSteps=5;
% slope steepness/exponent par "n" upper, lower, bounds, and steps for start grid
NRfitParsIn.nr_n_lower=2;
NRfitParsIn.nr_n_upper=10;
NRfitParsIn.nr_n_steps=5;
% "rmax" upper, lower, bounds, and steps for start grid
NRfitParsIn.nr_rmaxLower=0.25;
NRfitParsIn.nr_rmaxUpper=1;
NRfitParsIn.nr_rmaxSteps=5;
% "c50" upper, lower, bounds, and steps for start grid
NRfitParsIn.c50_lower=5;
NRfitParsIn.c50_upper=75;
NRfitParsIn.c50_steps=5;
% specify accuracy threshold values to solve the best fitting
% functions for at the end..
NRfitParsIn.thrldz2solve=[0.65, 0.75, 0.85];
%--------------------------------------------------------------------------

% Set Pars for analyzeBinnedAccuracy_v6:
%--------------------------------------------------------------------------
correctColNum=10;    % column number for column containing correctness info
accuracyParColNum=3; % column number for column containing the stimulus 
                     % parameter of interest along which you are assessing 
                     % accuracy
parName="TextSize";  % name/label for par in accuracyParColNum
binInfo=struct;      % initialize binning info struct
binInfo.min=5;       % min bin value
binInfo.max=75;      % max bin value
binInfo.nbins=25;    % total desired # of bins from min--> max
binInfo.binThresh=1; % total # of datapoints required for bin inclusion
otherThrPars={};     % Nx2 cell array: {colIdx, requiredValue}; pass [] or {} for none 
                     % these are sets of column index and threshold pairs 
                     % for further selecting a subset of trials with values 
                     % meeting that threshold for the par in that column 
yPltUpperLim=1;      % y plot axis upper limit
yPltLowerLim=0.25;   % y plot axis lower limit
yPltLimz=[yPltUpperLim, yPltLowerLim]; % single vector of containing both 
                                       % the upper and lower y axis limits 
                                       % specified above
%--------------------------------------------------------------------------
```

- Then run the script either by running `fitNakaRushton_example` in the Matlab Command Window or by hitting the green "Run" button at the top of the Matlab editor window.

- When finished, the resulting output figure image will be saved in the output directory path location specified by the `dirOut` parameter in the 'Set Parameters' section.

- Figures should look like the one pictured below generated from a limited # of trials on a toy experiment (current default settings in the included template/example PDF files) I ran on myself:
![exampleNRCurveFitFig](https://github.com/ejduwell/letterFlipper/blob/main/gh_READMEimgs/subj_JNK_TextSize_acc_by_bin_25bins_thresh1_randomString.png)

- Color indicates the # of data points in each bin that are contributing to the plotted mean values.
- Bin count also figures into the fitting routine. Bins with more datapoints are weighted proportionally in the fitting process.
- Dotted vertical lines demark the requested accuracy threshold solutions for subjects' respective fitted functions specified by `NRfitParsIn.thrldz2solve` in the 'Set Parameters' section

